<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ€¥æ€§ä¸Šå‘¼å¸é“æ„ŸæŸ“ç—…åŸé«”-ç–¾ç—…é—œè¯åœ–</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
        }
        
        body {
            background-color: #f8fafc;
            color: #333;
            line-height: 1.5;
            padding: 15px;
            max-width: 100%;
            margin: 0 auto;
            overflow-x: hidden; /* é˜²æ­¢æ©«å‘æ²è»¸ */
        }
        
        header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e1e8f0;
        }
        
        h1 {
            color: #2c3e50;
            font-size: 22px;
            margin-bottom: 8px;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 14px;
            margin-bottom: 10px;
        }
        
        .container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .legend {
            background-color: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
            border-left: 4px solid #3498db;
            margin-bottom: 20px;
        }
        
        .legend h3 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 16px;
            text-align: center;
        }
        
        .legend-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            flex-shrink: 0;
        }
        
        .color-box {
            width: 14px;
            height: 14px;
            margin-right: 5px;
            border-radius: 2px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            flex-shrink: 0;
        }
        
        .color-label {
            font-size: 12px;
            line-height: 1.2;
            white-space: nowrap;
        }
        
        /* ä¸»è¦ä½ˆå±€å®¹å™¨ */
        .bipartite-container {
            position: relative;
            min-height: 500px;
            margin: 30px 0;
            width: 100%;
        }
        
        /* ç—…åŸé«”æ©«æ’ */
        .pathogens-row {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            display: flex;
            flex-wrap: nowrap;
            gap: 12px;
            padding: 10px 0;
            white-space: nowrap;
            z-index: 20;
            overflow: visible; /* é—œéµï¼šç„¡æ²è»¸ï¼Œè®“ä½¿ç”¨è€…æ»‘å‹•æ‰‹æ©Ÿ */
        }
        
        /* ç–¾ç—…æ©«æ’ */
        .diseases-row {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            display: flex;
            flex-wrap: nowrap;
            gap: 15px;
            padding: 10px 0;
            white-space: nowrap;
            z-index: 20;
            overflow: visible; /* é—œéµï¼šç„¡æ²è»¸ï¼Œè®“ä½¿ç”¨è€…æ»‘å‹•æ‰‹æ©Ÿ */
        }
        
        /* é€£æ¥ç·šå€åŸŸ */
        .connections-area {
            position: absolute;
            top: 80px;
            bottom: 120px;
            left: 0;
            width: 100%;
            z-index: 10;
            overflow: visible;
        }
        
        /* ç—…åŸé«”å¡ç‰‡ */
        .pathogen-card {
            background-color: white;
            border-radius: 6px;
            padding: 10px 12px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
            border-left: 4px solid;
            transition: all 0.2s ease;
            cursor: pointer;
            flex-shrink: 0;
            min-width: 90px;
            text-align: center;
        }
        
        .pathogen-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
        }
        
        .pathogen-card.active {
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.3);
        }
        
        .pathogen-card.disease-active {
            box-shadow: 0 0 0 3px rgba(46, 204, 113, 0.5);
        }
        
        .pathogen-name {
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 4px;
        }
        
        .pathogen-type {
            font-size: 11px;
            color: #7f8c8d;
            font-style: italic;
        }
        
        /* ç–¾ç—…å¡ç‰‡ */
        .disease-card {
            background-color: white;
            border-radius: 6px;
            padding: 12px 15px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
            border-top: 3px solid #2c3e50;
            transition: all 0.2s ease;
            cursor: pointer;
            flex-shrink: 0;
            min-width: 180px;
            text-align: center;
        }
        
        .disease-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
        }
        
        .disease-card.active {
            box-shadow: 0 0 0 3px rgba(46, 204, 113, 0.3);
        }
        
        .disease-card.pathogen-active {
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.5);
        }
        
        .disease-location {
            font-size: 12px;
            font-weight: 600;
            color: #7f8c8d;
            margin-bottom: 5px;
            text-transform: uppercase;
        }
        
        .disease-name {
            font-size: 15px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 8px;
        }
        
        /* é—œéµä¿®æ”¹ï¼šç—‡ç‹€åˆ†è¡Œé¡¯ç¤º */
        .symptoms-container {
            font-size: 12px;
            color: #555;
            line-height: 1.4;
            padding: 8px;
            background-color: #f8f9fa;
            border-radius: 4px;
            border-left: 2px solid #e74c3c;
            text-align: left;
            margin: 0 auto;
            width: 100%;
        }
        
        .symptom-item {
            display: block;
            margin-bottom: 4px;
            padding-left: 8px;
            position: relative;
        }
        
        .symptom-item:before {
            content: "â€¢";
            position: absolute;
            left: 0;
            color: #e74c3c;
        }
        
        .symptom-item:last-child {
            margin-bottom: 0;
        }
        
        .references {
            font-size: 10px;
            color: #7f8c8d;
            font-style: italic;
            margin-top: 5px;
            text-align: center;
        }
        
        /* é€£æ¥ç·š */
        .connection-line {
            position: absolute;
            background-color: rgba(52, 152, 219, 0.6);
            height: 2px;
            transform-origin: 0 0;
            z-index: 1;
            pointer-events: none;
            transition: all 0.2s ease;
        }
        
        .connection-line.highlight {
            background-color: rgba(231, 76, 60, 0.8);
            height: 3px;
            z-index: 2;
        }
        
        .connection-line.disease-highlight {
            background-color: rgba(46, 204, 113, 0.8);
            height: 3px;
            z-index: 2;
        }
        
        /* æ§åˆ¶å€åŸŸ */
        .control-panel {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .mode-btn {
            padding: 8px 16px;
            background-color: #ecf0f1;
            color: #2c3e50;
            border: 2px solid #bdc3c7;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.2s;
            min-width: 120px;
        }
        
        .mode-btn.active {
            background-color: #3498db;
            color: white;
            border-color: #2980b9;
        }
        
        .mode-btn:hover {
            background-color: #d5dbdb;
        }
        
        .reset-btn {
            padding: 8px 20px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: background-color 0.2s;
        }
        
        .reset-btn:hover {
            background-color: #2980b9;
        }
        
        .instructions {
            background-color: #e8f4fc;
            border-radius: 6px;
            padding: 12px;
            margin: 15px 0;
            font-size: 13px;
            color: #2c3e50;
            text-align: center;
            border-left: 3px solid #3498db;
        }
        
        .clinical-tips {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
            border-left: 4px solid #e74c3c;
            margin-top: 20px;
        }
        
        .clinical-tips h3 {
            color: #2c3e50;
            margin-bottom: 12px;
            font-size: 16px;
        }
        
        .clinical-tips ul {
            padding-left: 18px;
            margin-bottom: 12px;
        }
        
        .clinical-tips li {
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        footer {
            text-align: center;
            margin-top: 25px;
            padding-top: 15px;
            border-top: 1px solid #e1e8f0;
            color: #7f8c8d;
            font-size: 12px;
        }
        
        /* æ‰‹æ©Ÿé©é… */
        @media (max-width: 768px) {
            .bipartite-container {
                min-height: 450px;
            }
            
            .connections-area {
                top: 70px;
                bottom: 110px;
            }
            
            .pathogen-card {
                min-width: 80px;
                padding: 8px 10px;
            }
            
            .disease-card {
                min-width: 160px;
                padding: 10px 12px;
            }
            
            .pathogens-row, .diseases-row {
                gap: 8px;
            }
            
            .disease-name {
                font-size: 14px;
            }
        }
        
        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            h1 {
                font-size: 20px;
            }
            
            .bipartite-container {
                min-height: 400px;
            }
            
            .connections-area {
                top: 60px;
                bottom: 100px;
            }
            
            .pathogen-card {
                min-width: 75px;
                padding: 6px 8px;
            }
            
            .pathogen-name {
                font-size: 12px;
            }
            
            .disease-card {
                min-width: 150px;
                padding: 8px 10px;
            }
            
            .disease-name {
                font-size: 13px;
            }
            
            .symptom-item {
                font-size: 11px;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>æ€¥æ€§ä¸Šå‘¼å¸é“æ„ŸæŸ“ç—…åŸé«”-ç–¾ç—…é—œè¯åœ–</h1>
        <div class="subtitle">ä¸Šæ–¹ç—…åŸé«”æ©«æ’ï¼Œä¸‹æ–¹ç–¾ç—…æ©«æ’ï¼Œé€£æ¥ç·šåœ¨ä¸­é–“</div>
    </header>
    
    <div class="container">
        <div class="legend">
            <h3>ç—…åŸé«”é¡è‰²åœ–ä¾‹</h3>
            <div class="legend-grid">
                <!-- åœ–ä¾‹ç”±JavaScriptå‹•æ…‹ç”Ÿæˆ -->
            </div>
        </div>
        
        <div class="instructions">
            é»æ“Šä¸Šæ–¹ç—…åŸé«”å¡ç‰‡ï¼ŒæŸ¥çœ‹å…¶å¯èƒ½å¼•èµ·çš„ç–¾ç—…<br>
            é»æ“Šä¸‹æ–¹ç–¾ç—…å¡ç‰‡ï¼ŒæŸ¥çœ‹å¯èƒ½å°è‡´è©²ç–¾ç—…çš„ç—…åŸé«”<br>
            <small>ï¼ˆå¡ç‰‡è¶…å‡ºè¢å¹•å¯¬åº¦æ™‚ï¼Œè«‹ç›´æ¥æ»‘å‹•æ‰‹æ©ŸæŸ¥çœ‹ï¼‰</small>
        </div>
        
        <div class="control-panel">
            <button class="mode-btn active" id="pathogenMode">ç—…åŸé«”æ¨¡å¼</button>
            <button class="mode-btn" id="diseaseMode">ç–¾ç—…æ¨¡å¼</button>
            <button class="reset-btn" id="resetBtn">é‡ç½®é«˜äº®</button>
        </div>
        
        <div class="bipartite-container">
            <!-- ç—…åŸé«”æ©«æ’ -->
            <div class="pathogens-row" id="pathogensRow">
                <!-- ç—…åŸé«”å¡ç‰‡ç”±JavaScriptå‹•æ…‹ç”Ÿæˆ -->
            </div>
            
            <!-- é€£æ¥ç·šå€åŸŸ -->
            <div class="connections-area" id="connectionsArea">
                <!-- é€£æ¥ç·šç”±JavaScriptå‹•æ…‹ç”Ÿæˆ -->
            </div>
            
            <!-- ç–¾ç—…æ©«æ’ -->
            <div class="diseases-row" id="diseasesRow">
                <!-- ç–¾ç—…å¡ç‰‡ç”±JavaScriptå‹•æ…‹ç”Ÿæˆ -->
            </div>
        </div>
        
        <div class="clinical-tips">
            <h3>ğŸ“‹ æ ¸å¿ƒè‡¨åºŠè¦é»</h3>
            <ul>
                <li><strong>æ©«æ’ä½ˆå±€</strong>ï¼šç—…åŸé«”åœ¨ä¸Šæ–¹æ©«æ’ï¼Œç–¾ç—…åœ¨ä¸‹æ–¹æ©«æ’ï¼Œé€£æ¥ç·šåœ¨ä¸­é–“é¡¯ç¤ºé—œè¯é—œä¿‚</li>
                <li><strong>é›™å‘äº’å‹•</strong>ï¼šé»æ“Šä»»ä¸€å¡ç‰‡å¯æŸ¥çœ‹ç›¸é—œè¯çš„å¦ä¸€æ–¹</li>
                <li><strong>å¤šç—…åŸé«”è‡´ç—…</strong>ï¼šä¸€ç¨®ç–¾ç—…å¯ç”±å¤šç¨®ç—…åŸé«”å¼•èµ·ï¼Œå¦‚é¼»ç‚å¯ç”±é¼»ç—…æ¯’ã€å† ç‹€ç—…æ¯’ã€è…ºç—…æ¯’ç­‰å¤šç¨®ç—…åŸé«”å¼•èµ·</li>
                <li><strong>ç—…åŸé«”ç‰¹ç•°æ€§</strong>ï¼šæŸäº›ç—…åŸé«”ä¸»è¦å¼•èµ·ç‰¹å®šéƒ¨ä½ç–¾ç—…ï¼Œå¦‚Aç¾¤éˆçƒèŒä¸»è¦å¼•èµ·å’½éƒ¨æ„ŸæŸ“</li>
                <li><strong>ç—‡ç‹€åˆ†è¡Œé¡¯ç¤º</strong>ï¼šæ¯å€‹ç—‡ç‹€å–®ç¨ä¸€è¡Œï¼Œä¾¿æ–¼é–±è®€</li>
            </ul>
        </div>
    </div>
    
    <footer>
        <p>æœ¬åœ–è¡¨æ ¹æ“šè‡¨åºŠæŒ‡å—åŠæ–‡ç»æ•´ç†ï¼Œåƒ…ä¾›å­¸ç¿’åƒè€ƒã€‚</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const pathogensRow = document.getElementById('pathogensRow');
            const diseasesRow = document.getElementById('diseasesRow');
            const connectionsArea = document.getElementById('connectionsArea');
            const legendGrid = document.querySelector('.legend-grid');
            const resetBtn = document.getElementById('resetBtn');
            const pathogenModeBtn = document.getElementById('pathogenMode');
            const diseaseModeBtn = document.getElementById('diseaseMode');
            
            let currentMode = 'pathogen';
            let connections = [];
            
            // æ ¹æ“šæ–°è¡¨æ ¼æ•´ç†çš„ç—…åŸé«”æ•¸æ“šï¼ˆä¿®æ­£ç‰ˆï¼‰
            const pathogens = [
                { name: 'é¼»ç—…æ¯’', type: 'ç—…æ¯’', color: '#FF6B6B' },
                { name: 'å† ç‹€ç—…æ¯’', type: 'ç—…æ¯’', color: '#FFA726' },
                { name: 'è…ºç—…æ¯’', type: 'ç—…æ¯’', color: '#4ECDC4' },
                { name: 'æµæ„Ÿç—…æ¯’', type: 'ç—…æ¯’', color: '#FF4081' },
                { name: 'å‘¼å¸é“åˆèƒç—…æ¯’', type: 'ç—…æ¯’', color: '#8D6E63' },
                { name: 'Aç¾¤éˆçƒèŒ', type: 'ç´°èŒ', color: '#7E57C2' },
                { name: 'å‰¯æµæ„Ÿç—…æ¯’', type: 'ç—…æ¯’', color: '#5C6BC0' },
                { name: 'è‚ºç‚éˆçƒèŒ', type: 'ç´°èŒ', color: '#26A69A' },
                { name: 'æµæ„Ÿå—œè¡€æ¡¿èŒ', type: 'ç´°èŒ', color: '#42A5F5' },
                { name: 'è«æ‹‰æ°èŒ', type: 'ç´°èŒ', color: '#9CCC65' },
                { name: 'è‚ºç‚é»´æ¼¿èŒ', type: 'éå…¸å‹ç—…åŸé«”', color: '#FF7043' }
            ];
            
            // æ ¹æ“šæ–°è¡¨æ ¼æ•´ç†çš„ç–¾ç—…æ•¸æ“šï¼ˆä¿®æ­£ç‰ˆï¼‰
            const diseases = [
                { 
                    location: 'é¼»è…”',
                    name: 'é¼»ç‚ã€æ™®é€šæ„Ÿå†’',
                    symptoms: ['é¼»å¡', 'æµæ¶•', 'æ‰“å™´åš', 'è¼•å¾®å’½ç—›', 'ä½ç†±'],
                    pathogens: ['é¼»ç—…æ¯’', 'å† ç‹€ç—…æ¯’', 'è…ºç—…æ¯’', 'æµæ„Ÿç—…æ¯’', 'å‘¼å¸é“åˆèƒç—…æ¯’'],
                    references: '[1-4]'
                },
                { 
                    location: 'å’½éƒ¨',
                    name: 'å’½å–‰ç‚ã€æ‰æ¡ƒé«”ç‚',
                    symptoms: ['å’½ç—›', 'ååš¥å›°é›£', 'ç™¼ç†±', 'æ‰æ¡ƒé«”è…«å¤§'],
                    pathogens: ['Aç¾¤éˆçƒèŒ', 'è…ºç—…æ¯’', 'é¼»ç—…æ¯’', 'å† ç‹€ç—…æ¯’', 'æµæ„Ÿç—…æ¯’', 'å‘¼å¸é“åˆèƒç—…æ¯’'],
                    references: '[3, 5-6]'
                },
                { 
                    location: 'å–‰éƒ¨',
                    name: 'å–‰ç‚ã€è²å¸¶ç‚',
                    symptoms: ['è²éŸ³å˜¶å•', 'å¤±è²', 'ä¹¾å’³', 'å–‰éƒ¨ä¸é©'],
                    pathogens: ['æµæ„Ÿç—…æ¯’', 'å‰¯æµæ„Ÿç—…æ¯’', 'è…ºç—…æ¯’', 'é¼»ç—…æ¯’', 'å† ç‹€ç—…æ¯’'],
                    references: '[1-3]'
                },
                { 
                    location: 'é¼»ç«‡',
                    name: 'é¼»ç«‡ç‚',
                    symptoms: ['é¼»å¡', 'é¢éƒ¨ç–¼ç—›', 'è†¿æ€§é¼»æ¶•', 'ç™¼ç†±'],
                    pathogens: ['è‚ºç‚éˆçƒèŒ', 'æµæ„Ÿå—œè¡€æ¡¿èŒ', 'è«æ‹‰æ°èŒ', 'é¼»ç—…æ¯’', 'å† ç‹€ç—…æ¯’', 'è…ºç—…æ¯’'],
                    references: '[4, 7-8]'
                },
                { 
                    location: 'ä¸­è€³',
                    name: 'ä¸­è€³ç‚',
                    symptoms: ['è€³ç—›', 'ç™¼ç†±', 'è½åŠ›ä¸‹é™', 'ç…©èº'],
                    pathogens: ['è‚ºç‚éˆçƒèŒ', 'æµæ„Ÿå—œè¡€æ¡¿èŒ', 'è«æ‹‰æ°èŒ', 'è…ºç—…æ¯’', 'é¼»ç—…æ¯’'],
                    references: '[3, 5-6]'
                },
                { 
                    location: 'ä¸‹å‘¼å¸é“',
                    name: 'æ”¯æ°£ç®¡ç‚ã€è‚ºç‚',
                    symptoms: ['å’³å—½', 'å–˜æ¯', 'ç™¼ç†±', 'èƒ¸æ‚¶', 'å‘¼å¸å›°é›£'],
                    pathogens: ['æµæ„Ÿç—…æ¯’', 'å‘¼å¸é“åˆèƒç—…æ¯’', 'è…ºç—…æ¯’', 'è‚ºç‚é»´æ¼¿èŒ', 'è‚ºç‚éˆçƒèŒ', 'æµæ„Ÿå—œè¡€æ¡¿èŒ'],
                    references: '[3, 5-6]'
                }
            ];
            
            // å‰µå»ºåœ–ä¾‹
            function createLegend() {
                legendGrid.innerHTML = '';
                pathogens.forEach(pathogen => {
                    const item = document.createElement('div');
                    item.className = 'legend-item';
                    item.innerHTML = `
                        <div class="color-box" style="background-color: ${pathogen.color};"></div>
                        <div class="color-label">${pathogen.name}</div>
                    `;
                    legendGrid.appendChild(item);
                });
            }
            
            // å‰µå»ºç—…åŸé«”å¡ç‰‡ï¼ˆæ©«æ’ï¼‰
            function createPathogenCards() {
                pathogensRow.innerHTML = '';
                pathogens.forEach((pathogen, index) => {
                    const card = document.createElement('div');
                    card.className = 'pathogen-card';
                    card.id = `pathogen-${index}`;
                    card.setAttribute('data-pathogen', pathogen.name);
                    card.style.borderLeftColor = pathogen.color;
                    
                    card.innerHTML = `
                        <div class="pathogen-name">${pathogen.name}</div>
                        <div class="pathogen-type">${pathogen.type}</div>
                    `;
                    
                    card.addEventListener('click', function() {
                        const pathogenName = this.getAttribute('data-pathogen');
                        setMode('pathogen');
                        highlightByPathogen(pathogenName);
                    });
                    
                    pathogensRow.appendChild(card);
                });
            }
            
            // å‰µå»ºç–¾ç—…å¡ç‰‡ï¼ˆæ©«æ’ï¼‰
            function createDiseaseCards() {
                diseasesRow.innerHTML = '';
                diseases.forEach((disease, index) => {
                    const card = document.createElement('div');
                    card.className = 'disease-card';
                    card.id = `disease-${index}`;
                    card.setAttribute('data-disease', disease.name);
                    card.setAttribute('data-location', disease.location);
                    
                    // å°‡ç—‡ç‹€è½‰æ›ç‚ºåˆ†è¡Œé¡¯ç¤ºçš„HTML
                    const symptomsHTML = disease.symptoms.map(symptom => 
                        `<div class="symptom-item">${symptom}</div>`
                    ).join('');
                    
                    card.innerHTML = `
                        <div class="disease-location">${disease.location}</div>
                        <div class="disease-name">${disease.name}</div>
                        <div class="symptoms-container">${symptomsHTML}</div>
                        <div class="references">${disease.references}</div>
                    `;
                    
                    card.addEventListener('click', function() {
                        const diseaseName = this.getAttribute('data-disease');
                        setMode('disease');
                        highlightByDisease(diseaseName);
                    });
                    
                    diseasesRow.appendChild(card);
                });
            }
            
            // å‰µå»ºé€£æ¥ç·š
            function createConnections() {
                connectionsArea.innerHTML = '';
                connections = [];
                
                // å»ºç«‹ç—…åŸé«”åˆ°ç–¾ç—…çš„æ˜ å°„é—œä¿‚
                pathogens.forEach(pathogen => {
                    diseases.forEach(disease => {
                        if (disease.pathogens.includes(pathogen.name)) {
                            const connection = document.createElement('div');
                            connection.className = 'connection-line';
                            connection.setAttribute('data-pathogen', pathogen.name);
                            connection.setAttribute('data-disease', disease.name);
                            connection.setAttribute('data-location', disease.location);
                            connection.style.backgroundColor = pathogen.color;
                            
                            connectionsArea.appendChild(connection);
                            connections.push({
                                element: connection,
                                pathogen: pathogen.name,
                                disease: disease.name,
                                location: disease.location,
                                color: pathogen.color
                            });
                        }
                    });
                });
                
                updateConnectionPositions();
            }
            
            // æ›´æ–°é€£æ¥ç·šä½ç½®ï¼ˆæ©«æ’ä½ˆå±€ï¼‰
            function updateConnectionPositions() {
                connections.forEach(conn => {
                    const pathogenCard = document.querySelector(`.pathogen-card[data-pathogen="${conn.pathogen}"]`);
                    const diseaseCard = document.querySelector(`.disease-card[data-disease="${conn.disease}"]`);
                    
                    if (!pathogenCard || !diseaseCard) return;
                    
                    const pathogenRect = pathogenCard.getBoundingClientRect();
                    const diseaseRect = diseaseCard.getBoundingClientRect();
                    const containerRect = connectionsArea.getBoundingClientRect();
                    
                    // è¨ˆç®—é€£æ¥ç·šèµ·é»å’Œçµ‚é»ï¼ˆå¾ç—…åŸé«”åº•éƒ¨åˆ°ç–¾ç—…é ‚éƒ¨ï¼‰
                    const startX = pathogenRect.left + pathogenRect.width / 2 - containerRect.left;
                    const startY = pathogenRect.bottom - containerRect.top;
                    const endX = diseaseRect.left + diseaseRect.width / 2 - containerRect.left;
                    const endY = diseaseRect.top - containerRect.top;
                    
                    // è¨ˆç®—ç·šæ¢é•·åº¦å’Œè§’åº¦
                    const deltaX = endX - startX;
                    const deltaY = endY - startY;
                    const length = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
                    const angle = Math.atan2(deltaY, deltaX) * 180 / Math.PI;
                    
                    // è¨­ç½®ç·šæ¢ä½ç½®å’Œæ¨£å¼
                    conn.element.style.width = `${length}px`;
                    conn.element.style.left = `${startX}px`;
                    conn.element.style.top = `${startY}px`;
                    conn.element.style.transform = `rotate(${angle}deg)`;
                    conn.element.style.opacity = '0.6';
                });
            }
            
            // é«˜äº®ç—…åŸé«”ç›¸é—œé …ç›®
            function highlightByPathogen(pathogenName) {
                resetHighlights();
                
                // é«˜äº®ç—…åŸé«”å¡ç‰‡
                const activePathogenCard = document.querySelector(`.pathogen-card[data-pathogen="${pathogenName}"]`);
                if (activePathogenCard) {
                    activePathogenCard.classList.add('active');
                }
                
                // æ‰¾åˆ°ç›¸é—œç–¾ç—…ä¸¦é«˜äº®
                connections.forEach(conn => {
                    if (conn.pathogen === pathogenName) {
                        const diseaseCard = document.querySelector(`.disease-card[data-disease="${conn.disease}"]`);
                        if (diseaseCard) {
                            diseaseCard.classList.add('pathogen-active');
                        }
                        
                        // é«˜äº®é€£æ¥ç·š
                        conn.element.classList.add('highlight');
                        conn.element.style.opacity = '1';
                        conn.element.style.zIndex = '15';
                    } else {
                        // æ·¡åŒ–ä¸ç›¸é—œé€£æ¥ç·š
                        conn.element.style.opacity = '0.2';
                    }
                });
            }
            
            // é«˜äº®ç–¾ç—…ç›¸é—œé …ç›®
            function highlightByDisease(diseaseName) {
                resetHighlights();
                
                // é«˜äº®ç–¾ç—…å¡ç‰‡
                const activeDiseaseCard = document.querySelector(`.disease-card[data-disease="${diseaseName}"]`);
                if (activeDiseaseCard) {
                    activeDiseaseCard.classList.add('active');
                }
                
                // æ‰¾åˆ°ç›¸é—œç—…åŸé«”ä¸¦é«˜äº®
                connections.forEach(conn => {
                    if (conn.disease === diseaseName) {
                        const pathogenCard = document.querySelector(`.pathogen-card[data-pathogen="${conn.pathogen}"]`);
                        if (pathogenCard) {
                            pathogenCard.classList.add('disease-active');
                        }
                        
                        // é«˜äº®é€£æ¥ç·š
                        conn.element.classList.add('disease-highlight');
                        conn.element.style.opacity = '1';
                        conn.element.style.zIndex = '15';
                    } else {
                        // æ·¡åŒ–ä¸ç›¸é—œé€£æ¥ç·š
                        conn.element.style.opacity = '0.2';
                    }
                });
            }
            
            // é‡ç½®é«˜äº®
            function resetHighlights() {
                document.querySelectorAll('.pathogen-card').forEach(card => {
                    card.classList.remove('active');
                    card.classList.remove('disease-active');
                });
                
                document.querySelectorAll('.disease-card').forEach(card => {
                    card.classList.remove('active');
                    card.classList.remove('pathogen-active');
                });
                
                connections.forEach(conn => {
                    conn.element.classList.remove('highlight');
                    conn.element.classList.remove('disease-highlight');
                    conn.element.style.opacity = '0.6';
                    conn.element.style.zIndex = '1';
                });
            }
            
            // è¨­ç½®æ¨¡å¼
            function setMode(mode) {
                currentMode = mode;
                
                if (mode === 'pathogen') {
                    pathogenModeBtn.classList.add('active');
                    diseaseModeBtn.classList.remove('active');
                } else {
                    diseaseModeBtn.classList.add('active');
                    pathogenModeBtn.classList.remove('active');
                }
            }
            
            // äº‹ä»¶ç›£è½å™¨
            pathogenModeBtn.addEventListener('click', () => setMode('pathogen'));
            diseaseModeBtn.addEventListener('click', () => setMode('disease'));
            resetBtn.addEventListener('click', resetHighlights);
            
            // ç•¶çª—å£å¤§å°è®ŠåŒ–æˆ–æ»¾å‹•æ™‚æ›´æ–°é€£æ¥ç·šä½ç½®
            window.addEventListener('resize', updateConnectionPositions);
            window.addEventListener('scroll', updateConnectionPositions);
            
            // åˆå§‹åŒ–
            createLegend();
            createPathogenCards();
            createDiseaseCards();
            createConnections();
            
            // åˆå§‹é«˜äº®
            setTimeout(() => {
                setMode('pathogen');
                highlightByPathogen('é¼»ç—…æ¯’');
            }, 500);
            
            // ç›£è½æ©«å‘æ»¾å‹•ä»¥æ›´æ–°é€£æ¥ç·šä½ç½®
            let scrollTimeout;
            pathogensRow.addEventListener('scroll', function() {
                clearTimeout(scrollTimeout);
                scrollTimeout = setTimeout(updateConnectionPositions, 100);
            });
            
            diseasesRow.addEventListener('scroll', function() {
                clearTimeout(scrollTimeout);
                scrollTimeout = setTimeout(updateConnectionPositions, 100);
            });
        });
    </script>
</body>
</html>
